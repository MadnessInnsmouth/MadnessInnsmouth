# FM26 Accessibility Plugin - Build Instructions

## Building the Plugin

This plugin targets BepInEx 6 (IL2CPP). BepInEx and HarmonyX are consumed via NuGet packages from the BepInEx feed. You have two options:

### Option 1: Use Pre-Built Release

Download the latest pre-built release from the [Releases page](https://github.com/MadnessInnsmouth/MadnessInnsmouth/releases).

### Option 2: Build from Source

#### Prerequisites

1. **Visual Studio 2022 or later** (Community edition is free)
   - Install .NET desktop development workload
   - Install .NET 6.0 SDK

2. **Cpp2IL** (for generating IL2CPP interop assemblies)
   - **Auto-installed by build script** - The build script will automatically install Cpp2IL if it's not already present
   - Alternatively, manually install: `dotnet tool install -g Cpp2IL`
   - Or download from: https://github.com/SamboyCoding/Cpp2IL/releases
   - Used to generate interop assemblies from FM26's `GameAssembly.dll` and `fm_Data/il2cpp_data/Metadata/global-metadata.dat`

3. **IL2CPP Interop Assemblies**
   - Generated by Cpp2IL from your Football Manager 2026 installation
   - Placed in: `lib/interop/`
   - You need (at minimum):
     - `UnityEngine.dll`
     - `UnityEngine.UI.dll`
     - `UnityEngine.CoreModule.dll`

   **Note:** BepInEx and HarmonyX are provided via NuGet packages (configured in `NuGet.config`) and do not need to be downloaded manually.

#### Build Steps

1. **Generate Interop Assemblies**
   ```bash
   mkdir -p lib/interop
   # Run Cpp2IL against your FM26 installation to generate interop DLLs
   # Place the generated assemblies in lib/interop/
   ```

2. **Restore NuGet Packages**
   ```bash
   dotnet restore src/FM26AccessibilityPlugin/FM26AccessibilityPlugin.csproj
   ```

3. **Build**
   ```bash
   dotnet build src/FM26AccessibilityPlugin/FM26AccessibilityPlugin.csproj --configuration Release
   ```

4. **Output**
   - Built DLL will be in: `src/FM26AccessibilityPlugin/bin/Release/net6.0/FM26AccessibilityPlugin.dll`

## Alternative: Use Included Build Script

For convenience, we've included a build script that handles everything:

### Windows (PowerShell)
```powershell
.\build\build.ps1
```

This script will:
1. Check for required dependencies
2. Download BepInEx 6 (IL2CPP) if needed
3. **Auto-install Cpp2IL if not already present**
4. Run Cpp2IL to generate interop assemblies from your FM26 installation
5. Build the plugin
6. Create a release package

## After Building

Once built, use the installer to deploy:
```powershell
.\install\Install-FM26Accessibility.ps1
```

## Development Setup

For active development:

1. Set `FM26_PATH` environment variable to your FM26 installation
2. The build will automatically copy the plugin to the game directory
3. Run FM26 to test changes

## Troubleshooting

### Missing References

If you get missing reference errors:
- Ensure interop assemblies are generated in `lib/interop/`
- Run `dotnet restore` to fetch NuGet packages
- Update reference paths in the `.csproj` file if needed

### Build Fails

- Check that .NET 6.0 SDK is installed
- Verify all reference DLLs are present
- Try cleaning: `dotnet clean` then rebuild

## CI/CD

GitHub Actions automatically builds the plugin on push. See `.github/workflows/build.yml` for the workflow configuration.
